{% extends "base.html" %} {% block content %}
<h2>Dashboard</h2>
<p>Welcome, {{ current_user.name }}!</p>
<p>Your role: {{ current_user.role }}</p>
<a class="btn btn-primary" href="{{ url_for('main.create_ticket') }}"
  >Create Ticket</a
>
{% if current_user.role == 'support' or current_user.role == 'admin' %}
<a class="btn btn-secondary" href="{{ url_for('main.unassigned_tickets') }}"
  >View Unassigned Tickets</a
>
{% endif %}

<h3>Your Tickets</h3>
<table class="table">
  <thead>
    <tr>
      <th>Title</th>
      <th>Description</th>
      <th>Priority</th>
      <th>Status</th>
      <th>Assigned To</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for ticket in tickets %}
    <tr>
      <td>{{ ticket.title }}</td>
      <td>{{ ticket.description }}</td>
      <td>{{ ticket.priority }}</td>
      <td>{{ ticket.status }}</td>
      <td>{{ ticket.assignee.name if ticket.assignee else 'Unassigned' }}</td>
      <td>
        <a
          href="{{ url_for('main.ticket_details', ticket_id=ticket.id) }}"
          class="btn btn-info"
          >View</a
        >
        {% if current_user.role == 'admin' %}
        <a
          href="{{ url_for('main.assign_ticket', ticket_id=ticket.id) }}"
          class="btn btn-warning"
          >Assign</a
        >
        {% endif %}
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
